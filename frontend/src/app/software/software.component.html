<app-header></app-header>
<app-sidebar></app-sidebar>

<main class="pl-200">

  <!-- breadcrumb-section - start
        ================================================== -->
  <section id="breadcrumb-section" class="breadcrumb-section bg-white clearfix">
    <div class="container">
      <nav class="breadcrumb-nav ul-li clearfix">
        <ul class="clearfix">
          <li><a href="#!">Customer : </a>{{customerData.name}}</li>
          <li><a href="#!">Cluster : </a>{{clusterData.cluster_name}}</li>
          <li>Stack : {{clusterData.cnox_stack}}</li>
        </ul>
      </nav>
    </div>
  </section>
  <!-- breadcrumb-section - end
        ================================================== -->


  <!-- software-section - start
        ================================================== -->
  <section id="software-section" class="software-section sec-ptb-60 clearfix">
    <div class="container">

      <div class="section-title mb-15">
        <h2 class="title-text mb-0">Image Scan</h2>
      </div>

      <div class="item-wrapper image-scan min-h-auto">
        <div class="row d-flex align-items-center">
          <div class="col-lg-8 col-md-8 col-sm-12">
            <div class="scan-list ul-li text-center clearfix">
              <ul class="clearfix">
                <li>
                  <button type="button">
                    <span class="bg-default-red">{{ReportTotal.Critical}}</span>
                    <small>critical</small>
                  </button>
                </li>
                <li>
                  <button type="button">
                    <span class="bg-default-orange">{{ReportTotal.High}}</span>
                    <small>high</small>
                  </button>
                </li>
                <li>
                  <button type="button">
                    <span class="bg-default-yellow">{{ReportTotal.Medium}}</span>
                    <small>medium</small>
                  </button>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-12" style="padding-right: 80px;">
            <button type="button" (click)="onScannerURL()"
                    [ngClass]="(scannerUrl === 'undefined') ? 'btn-secondary': 'bg-default-orange'"
                    [disabled]="scannerUrl === 'undefined'"
                    class="custom-btn rounded float-right text-uppercase">Scanner
            </button>
          </div>

          <div class="col-lg-8 col-md-8 col-sm-12"></div>
          <div class="col-lg-4 col-md-4 col-sm-12">
            <div style="margin-top: -55px;float: right; font-size: 24px" *ngIf="!newUpdate;else other_content2">
              <!--              Syncing Vulnerability Feeds-->
            </div>
            <ng-template #other_content2>
              <div class="time-content" style="margin-top: -55px; margin-left: 70px;">
                <p class="mb-1">Last scanned on :</p>
                <span>{{lastScanValue | date: 'yyyy-MM-dd hh:mm a'}}</span>
              </div>
            </ng-template>
          </div>

        </div>
      </div>

      <div class="item-wrapper">
        <div class="wrapper-head text-center">
          <div class="tabs-nav ul-li-center clearfix">
            <ul class="nav" role="tablist">
              <li>
                <a class="active" data-toggle="tab" href="#byimage-tab">By Image</a>
              </li>
              <li>
                <a data-toggle="tab" href="#bysev-tab">By Sev</a>
              </li>
            </ul>
          </div>
        </div>

        <!-- Tab panes -->
        <div class="tab-content">
          <div id="byimage-tab" class="tab-pane active ">
            <div class="cnox-protection-table">
              <div class="table-container tbody-container scroll-bar">
                <ngx-datatable
                  #myTable
                  class='material expandable bootstarp'
                  [rows]="src"
                  [groupRowsBy]="'Image'"
                  [columnMode]="'force'"
                  [headerHeight]="50"
                  [footerHeight]="50"
                  [rowHeight]="'auto'"
                  [externalPaging]="true"
                  [count]=5
                  [limit]=5
                  [groupExpansionDefault]="false">
                  <!-- Group Header Template -->
                  <ngx-datatable-group-header [rowHeight]="'auto'" #myGroupHeader (toggle)="onDetailToggle($event)">
                    <ng-template let-group="group" let-expanded="expanded" ngx-datatable-group-header-template>
                      <div style="padding-left:5px;">
                        <a
                          [class.datatable-icon-right]="!expanded"
                          [class.datatable-icon-down]="expanded"
                          title="Expand/Collapse Group"
                          (click)="toggleExpandGroup(group)">
                          <span>{{group.value[0].Image}}</span>
                        </a>
                      </div>
                    </ng-template>
                  </ngx-datatable-group-header>
                  <ngx-datatable-column
                    [width]="50"
                    [resizeable]="false"
                    [sortable]="false"
                    [draggable]="false"
                    [canAutoResize]="false">
                  </ngx-datatable-column>
                  <ngx-datatable-column name="Image"></ngx-datatable-column>
                  <ngx-datatable-column name="Vulnerability" prop="Vulnerability"></ngx-datatable-column>
                  <ngx-datatable-column name="Severity" prop="Severity"></ngx-datatable-column>
                </ngx-datatable>



                <!--<ngx-datatable
                  #myTable
                  class="material expandable"
                  [columnMode]="'force'"
                  [groupRowsBy]="'head'"
                  [headerHeight]="50"
                  [footerHeight]="50"
                  [rowHeight]="'auto'"
                  [externalPaging]="true"
                  [count]=5
                  [limit]=pageSize
                  [rows]="src"
                  [groupExpansionDefault]="true"
                >
                  &lt;!&ndash; Row Detail Template &ndash;&gt;
                  <ngx-datatable-row-detail rowHeight="'auto'" #myDetailRow
                                            (toggle)="onDetailToggle($event)">
                    <ng-template let-row="row" let-expanded="expanded"
                                 ngx-datatable-row-detail-template>
                      <div>
                        <table class="table">
                          <thead>
                            <th>Vulnerability</th>
                            <th>Severity</th>
                          </thead>
                          <tbody>
                          <tr>
                            <td>{{row.Vulnerability}}</td>
                            <td>{{row.Severity}}</td>
                          </tr>
                          </tbody>
                        </table>
                      </div>
                    </ng-template>
                  </ngx-datatable-row-detail>
                  <ngx-datatable-column
                    [width]="50"
                    [resizeable]="false"
                    [sortable]="false"
                    [draggable]="false"
                    [canAutoResize]="false"
                  >
                    <ng-template let-row="row" let-expanded="expanded"
                                 ngx-datatable-cell-template>
                      <a
                        href="javascript:void(0)"
                        [class.datatable-icon-right]="!expanded"
                        [class.datatable-icon-down]="expanded"
                        title="Expand/Collapse Row"
                        (click)="toggleExpandRow(row)"
                      >
                      </a>
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column>
                    <ng-template ngx-datatable-header-template>
                      <span>Image</span>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.Image}}
                    </ng-template>
                  </ngx-datatable-column>
                 &lt;!&ndash; <ngx-datatable-column name="head" prop="head">
                    <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                      <strong>{{value}}</strong>
                    </ng-template>
                  </ngx-datatable-column>&ndash;&gt;
                </ngx-datatable>-->
                <!--<table class="table">
                  <thead>
                  <tr>
                    <th>Image</th>
                    <th>Vulnerability</th>
                    <th>Severity</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let data of src">
                    <td>{{data.Image}}</td>
                    <td>{{data.Vulnerability}}</td>
                    <td>{{data.Severity}}</td>
                  </tr>
                  </tbody>
                </table>-->
              </div>
            </div>
          </div>

          <div id="bysev-tab" class="tab-pane  text-center fade">
            <div class="cnox-protection-table">
              <div class="table-container tbody-container scroll-bar">
                <!--<table class="table">
                  <thead>
                  <tr>
                    <th>Sev</th>
                    <th>CVE</th>
                    <th>Image</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let data of sevData">
                    <td>{{data.Severity}}</td>
                    <td>{{data.Vulnerability}}</td>
                    <td>{{data.Image}}</td>
                  </tr>
                  </tbody>
                </table>-->
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>
  <!-- software-section - end
        ================================================== -->

</main>
